---
layout: docpage
section: UserGuide
topic: smf
---
{{> userguide_menu}}
<div class=lz-r-content>
    <h3>Software Management Framework</h3>
    <p>The LazyStack SMF provides an end-to-end Software Management Framework integrating AWS Services, GitHub and the LazyStack developer tools. In the Install process, the following process was followed to configure an AWS Organization.</p>
    <img src="/assets/img/LazyStackSMFSetup.svg" width="600">
    <p></p>
    <p>An abstract view of the organizational hierarchy is presented below. This abstraction includes an organization 
        which manages one or more systems and each of those systems contains one or more serverless stacks. In addition,
        a collaborative development workflow around "features" is included.</p>
        <img src="/assets/img/LazyStackSMFSetup10.svg" width="600">
    <p></p>
    <p>A high-level view of a concrete implementation of this organization looks like this:</p>
    <img src="/assets/img/AwsSetup2.svg" width="600">
    <p> </p>
    <p>In the diagram above, GitHub integration is shown and GitHub Pull Requests are used to coordinate the 
        review and approval of features coded by a developer. In this diagram we see:
    </p>
    <ul>
        <li>Developers publish from their workstation directly to their AWS "sandbox" Account</li>
        <li>Pull Requests publish PR Stacks in the Test Account. This is accomplished using 
            AWS CodeBuild projects connected to GitHub WebHooks. More on this follows.
        </li>
        <li>PUll Requests publish Prod Stack in the Production Account. This is also accomplished 
            using AWS CodeBuild projects connected to GitHub WebHooks. More on this follows.
        </li>
    </ul>


    <p>An abstract view of the steps in the collaborative development process looks like this:
    </p>
    <img src="/assets/img/LazyStackSMF20.svg" width="700"> 
    <p></p>
    <p>A concrete implementation of the collaborative development process using Visual Studio IDE integration with GitHub looks like this:</p>
    <img src="/assets/img/SDLCFeatureFlowVSIDEOverview.svg" width="100%">
    <p></p>

    <p>In the diagram above, developers publish serverless stacks to their own AWS Account for rapid prototyping and testing,
        but have no direct connection to a Test or Production account. Instead, each serverless stack has its own GitHub 
        repository and updates to serverless stacks in the Test and Production accounts are based on Pull Requests in that 
        GitHub repository; more on that later.
    </p>
    
    <h5>Developer Accounts</h5>
    <p>Each developer has their own "sandbox" AWS Account. This account fully isolates the developer resources from other 
        developers resources, and the resources used in Test and Production accounts. The key concept here is that AWS 
        Accounts isolate resources. Since serverless stacks do not incur significant cost unless they are being exercised, 
        there is no downside to providing each developer with their own AWS Account. As a general rule, it requires a 
        very intentional configuration to enable resources to be shared across AWS Accounts and this is only necessary in 
        fairly complex situations that don't usually occur when building serverless stacks. 
    </p>
    <p>From a Developer's perspective, their development environment looks like this:</p>
    <img src="/assets/img/LazyStackSMF1.1.svg" width="600">
    <p></p>
    <p>The developer is free to code serverless stack features and publish that stack in their AWS Account frequently and 
        without fear they will affect anyone else on the team. This freedom is key to rapid prototyping and development.
        AWS provides three tools for publishing serverless stacks:
    </p>
    <ul>
        <li>AWS CLI using CloudFormation commands</li>
        <li>AWS SAM CLI</li>
        <li>AWS Visual Studio IDE Extension</li>
    </ul>
    <p>We focus on and recommend using the AWS SAM CLI for command line work and in shell scripts. We also recommend 
        using the AWS Visual Studio IDE Extension. There is no advantage to using the AWS CLI cloudformation commands 
        if you have AWS SAM CLI installed. The AWS CLI is super helpful for lots of other uses, but publishing 
        serverless stacks is easier with the AWS SAM CLI.
    </p>

    <p>The LazyStack developer tools, described in the User Guide Developer Tools section, generate serverless stack 
        code and configurations. The tools also include an AWS Settings generator that calls a published stack and 
        retrieves the information necessary to configure a client app to successfully call that stack in a secure way.
         </p>

    <h5>AWS IAM Users</h5>
    <p>Every AWS Account has a root user. That root user is associated with a email address that is unique 
        among AWS Accounts - you can't use the same email address for more than one account. You sign into 
        the root user account using at least that email address and a password. Signing into an account 
        using the root user credentials should only be done for a limited number of account management 
        reasons. All other access should be performed through a IAM User login.
    </p>
    <p>We create a single IAM User for each AWS Account created in the AWS Organization. See the diagram 
        below:
    </p>
    <p></p>
    <img src="/assets/img/AwsProdSetup.svg" width="700">
    <p></p>
    <h5>AWS CLI Named Profiles</h5>
    <p>The AWS tools use local AWS profiles to authenticate calls from a workstation to the AWS Cloud. An 
        AWS profile contains an AccessKeyID and a SecretKey. By selected a named profile, you are instructing 
        an AWS tool to use that AccessKey pair to authenticate with a specific AWS Cloud Account. Consider
        the named profiles in the previous section's diagram:
    </p>
    <ul>
        <li>Management Workstation
            <ul>
                <li>OrgMgmt - account from which AWS Organization is managed. AdministratorAccess.</li>
                <li>OrgDevJoeAccess - Allows OrgMgmt account to assume administrator role in OrgDevJoe Account</li>
                <li>OrgSysTestAccess - Allows OrgMgmt account to assume administrator role in OrgSysTest Account</li>
                <li>OrgSysProdAccess - Allows OrgMgmt account to assume administrator role in OrgSysProd Account</li>
            </ul>
        </li>
        <li>Joe's Development Workstation
            <ul>
                <li>OrgDevJoe - Provides PowerUser Access and select IAM permissions</li>
            </ul>
        </li>
        <li>OrgSysTest Workstation
            <ul>
                <li>OrgSysTest - AdministratorAccess</li>
            </ul>
        </li>
        <li>OrgSysProd Workstation
            <ul>
                <li>OrgSysProd - AdministratorAccess</li>
            </ul>
        </li>
    </ul>
    <p>AWS allows you to create a "default" profile that will be used if you don't supply a specific profile 
        name when executing an AWS tool. We strongly recommend that you never use a default profile on the 
        Management Workstation. We also recommend you only use a default profile on a Developer's Workstation 
        when they will only ever be working against a single AWS Account.
    </p>
    
</div>